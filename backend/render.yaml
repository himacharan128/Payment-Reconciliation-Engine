services:
  # API Service
  - type: web
    name: payment-reconciliation-api
    runtime: go
    buildCommand: go clean -cache && go build -o app ./cmd/api
    startCommand: ./app
    envVars:
      - key: DATABASE_URL
        sync: false  # Set this manually in Render dashboard with your NeonDB connection string
      - key: PORT
        value: 8080
    healthCheckPath: /health

  # Worker Service
  - type: worker
    name: payment-reconciliation-worker
    runtime: go
    buildCommand: go clean -cache && go build -o app ./cmd/worker
    startCommand: ./app
    envVars:
      - key: DATABASE_URL
        sync: false  # Set this manually in Render dashboard with your NeonDB connection string
      - key: JOB_POLL_INTERVAL_MS
        value: 1000
